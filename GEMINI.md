# PowerShellスクリプト `pptxextract` 開発仕様書

## 概要

以下は、PowerPointファイルからコンテンツを抽出するPowerShellスクリプト `pptxextract` を開発するための仕様書です。この仕様に従って、関連ファイル一式を開発・作成してください。

## 1. 主要アプリケーション: `extract_pptx_content.ps1`

以下の機能を持つPowerShellスクリプトを作成してください。

- **入力**:
    - `-PptxPath` という引数でPowerPointファイルのパスを受け取ります。
    - 引数が指定されない場合は、GUIのファイル選択ダイアログを表示して、ユーザーが `.pptx` ファイルを選択できるようにしてください。
- **出力**:
    - 入力されたPowerPointファイルと同じディレクトリに、以下の2つのファイルを生成します。
    - **PDFファイル**: プレゼンテーション全体をPDF化したもの。ファイル名は `(元のファイル名).pdf` とします。
    - **ノートテキストファイル**: 各スライドのノートを抽出したもの。ファイル名は `(元のファイル名).txt` とします。
- **ノートテキストファイルの内容**:
    - 各スライドのノートテキストを抽出します。
    - ノートの後には、改行して対応するページ番号（例: `1ページ目`）を記載します。
    - さらに改行して、区切り線として `ーーーー` を記載します。
    - この形式で全スライドのノートを1つのファイルに結合します。
- **その他**:
    - COMオブジェクトを使用するため、適切なエラーハンドリングと、処理終了後のPowerPointプロセスの解放処理を必ず実装してください。

## 2. ドキュメント: `README.md`

上記スクリプトの利用方法を説明する `README.md` を作成してください。最低限、以下の項目を含めてください。

- アプリケーションの概要
- 機能一覧
- 使い方（引数を渡す場合と、ダイアログを使う場合の両方）
- 出力されるファイルについての説明
- 動作要件（PowerShell, Microsoft PowerPoint）

## 3. Git/エディタ連携設定

PowerShellスクリプトは `UTF-16LE (BOM付き)` で保存する必要があります。Gitリポジトリでこのエンコーディングを正しく扱うため、以下の設定ファイルを作成してください。

- **`.gitattributes`**:
    - `.ps1` ファイルが `UTF-16LE` のテキストファイルであり、改行コードが `CRLF` であることをGitに指示する設定を記述してください。
    - 例: `*.ps1 text working-tree-encoding=UTF-16LE eol=crlf`
- **`.editorconfig`**:
    - エディタが `.ps1` ファイルを自動的に `charset = utf-16le` および `end_of_line = crlf` として扱うように設定してください。
    - 他のファイル形式についても、一般的な整形設定（末尾の空白削除など）を含めてください。